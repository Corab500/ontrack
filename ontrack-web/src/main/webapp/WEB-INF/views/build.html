<#include "/lib/layout.html">

<@layout_std page="build" title=build.name modules=["projects","branches","builds","validation_stamps","audit","properties"] breadcrumbs = {loc("home"): "", build.branch.project.name?html: "gui/project/${build.branch.project.name?html}", build.branch.name?html: "gui/project/${build.branch.project.name?html}/branch/${build.branch.name?html}"}>
	<div class="container-fluid">
        <div class="row-fluid">
            <div class="span12 page-title">
                <span class="title">
                    <a href="gui/project/${build.branch.project.name?html}">${build.branch.project.name?html}</a>
                    / <a href="gui/project/${build.branch.project.name?html}/branch/${build.branch.name?html}">${build.branch.name?html}</a>
                    / ${build.name?html}
                </span>
                <span class="action action-optional">
                    <span onclick="location='gui/project/${build.branch.project.name?html}/branch/${build.branch.name?html}'"><i class="icon-remove"></i> <@lh key="general.close" /></span>
                </span>
            </div>
            <div class="span12 muted">${build.description?html}</div>
            <div class="span12">
                <@properties entity="BUILD" entityId=build.id />
            </div>
        </div>
		<div class="row-fluid">
            <div class="span4">
                <@panel title=loc("build.validation_stamps")>
                    <@dynamicsection
                        id="build-validation-stamp-list"
                        template="Builds.buildValidationStampTemplate('${build.branch.project.name?html}', '${build.branch.name?html}', '${build.name?html}')">
                    </@dynamicsection>
                    <script id="buildValidationStampsTemplate" type="text/html">
                        <tr>
                            <td>
                                <div class="{{^stamp.run}}validation-stamp-norun{{/stamp.run}}">
                                    <img class="tooltip-source" width="24" title="{{stamp.name}}" src="gui/project/{{project}}/branch/{{branch}}/validation_stamp/{{stamp.name}}/image" />
                                    <a class="tooltip-source" href="gui/project/{{project}}/branch/{{branch}}/validation_stamp/{{stamp.name}}">{{stamp.name}}</a>
                                    {{#stamp.runs}}
                                        <p class="validation-run status-{{status}}">
                                            <a
                                                    class="tooltip-source"
                                                    href="gui/project/{{../project}}/branch/{{../branch}}/build/{{../build}}/validation_stamp/{{../stamp.name}}/validation_run/{{runOrder}}"
                                                    title="{{statusDescription}} - {{signature.elapsedTime}} - {{signature.formattedTime}}">
                                                <i class="icon-play"></i>
                                                <span class="validation-run-status">{{status}}</span>
                                            </a>
                                        </p>
                                    {{/stamp.runs}}
                                </div>
                            </td>
                        </tr>
                    </script>
                </@panel>
            </div>
            <div class="span4">
                <@panel title=loc("build.promotion_levels")>
                    <@dynamicsection
                        id="build-promotion-level-list"
                        template="Builds.buildPromotionLevelsTemplate('${build.branch.project.name?html}', '${build.branch.name?html}', '${build.name?html}')">
                    </@dynamicsection>
                </@panel>
            </div>
			<div class="span4">
				<@panel title=loc("event.list")>
					<@audit filter="&build=${build.id}" />
				</@panel>
			</div>
		</div>
	</div>
</@layout_std>