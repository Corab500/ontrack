<#include "/lib/layout.html">

<#macro promotion_level_options selection>
    <@form_select_option value="" text="" />
    <#list promotionLevels as promotionLevel>
        <@form_select_option value=promotionLevel.name text=promotionLevel.name selection=selection />
    </#list>
</#macro>

<#macro validation_stamp_options selection>
    <@form_select_option value="" text="" />
    <#list validationStamps as validationStamp>
        <@form_select_option value=validationStamp.name text=validationStamp.name selection=selection />
    </#list>
</#macro>

<#macro statuses selection>
    <@form_select_option value="" text="" />
    <#list statusList as status>
        <@form_select_option value=status text=status selection=selection />
    </#list>
</#macro>

<@layout_std
    page="build.log"
    modules=["projects","branches","builds","validation_stamps","promotion_levels","audit"]
    breadcrumbs = {
        loc("home"): "",
        branch.project.name?html: "gui/project/${branch.project.name?html}",
        branch.name?html: "gui/project/${branch.project.name?html}/branch/${branch.name?html}"}>
	<div class="container-fluid">
        <div class="row-fluid">
            <div class="span12">
                <form class="alert alert-info">
                    <table>
                        <tbody>
                            <tr>
                                <td>
                                    <@lh key="build.log.withPromotionLevel" />
                                    <select name="withPromotionLevel" class="input-small">
                                        <@promotion_level_options selection="${query.withPromotionLevel!''?html}" />
                                    </select>
                                </td>
                            </tr>
                            <tr>
                                <td>
                                    <@lh key="build.log.sincePromotionLevel" />
                                    <select name="sincePromotionLevel" class="input-small">
                                        <@promotion_level_options selection="${query.sincePromotionLevel!''?html}" />
                                    </select>
                                </td>
                            </tr>
                            <tr>
                                <td>
                                    <@lh key="build.log.withValidationStamp" />
                                    <select name="withValidationStamp" class="input-large">
                                        <@validation_stamp_options selection="${query.withValidationStamp!''?html}" />
                                    </select>
                                    <@lh key="build.log.withValidationStamp.status" />
                                    <select name="withValidationStampStatus" class="input-medium">
                                        <@statuses selection="${query.withValidationStampStatus!''?html}" />
                                    </select>
                                </td>
                            </tr>
                            <tr>
                                <td>
                                    <@lh key="build.log.sinceValidationStamp" />
                                    <select name="sinceValidationStamp" class="input-large">
                                        <@validation_stamp_options selection="${query.sinceValidationStamp!''?html}" />
                                    </select>
                                    <@lh key="build.log.sinceValidationStamp.status" />
                                    <select name="sinceValidationStampStatus" class="input-medium">
                                        <@statuses selection="${query.sinceValidationStampStatus!''?html}" />
                                    </select>
                                </td>
                            </tr>
                            <tr>
                                <td>
                                    <@lh key="build.log.limit" />
                                    <input name="limit" type="number" class="input-mini" min="1" value="${query.limit?c}" max="100" maxlength="3" />
                                </td>
                            </tr>
                            <tr>
                                <td>
                                    <button type="submit" class="btn btn-primary"><@lh key="build.log.submit" /></button>
                                    <a href="gui/project/${branch.project.name?html}/branch/${branch.name?html}" class="btn btn-link"><@lh key="general.close" /></a>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </form>
            </div>
        </div>
        <div class="row-fluid">
            <div id="builds" class="span12 hidden">

            </div>
        </div>
	</div>
</@layout_std>