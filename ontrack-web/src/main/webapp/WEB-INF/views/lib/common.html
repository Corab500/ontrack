<#import "/spring.ftl" as spring />
<#include "/lib/i18n.html" />

<#macro usermessage>
	<#if usermessage??>
		<div class="alert alert-${usermessage.type}">
			${usermessage.message?html}
		</div>
	</#if>
</#macro>

<#macro yes_no value>
	<#if value>
		<@lh key="general.yes" />
	<#else>
		<@lh key="general.no" />
	</#if>
</#macro>

<#macro panel id = "" title = "" class = "">
	<#assign idSection = "" />
	<#assign idTitle = "" />
	<#assign idContent = "" />
	<#if id != "" >
		<#assign idSection = 'id="' + id + '"' />
		<#assign idTitle = 'id="' + id + '-title"' />
		<#assign idContent = 'id="' + id + '-content"' />
	</#if>
	<section class="panel ${class?html}" ${idSection}>
		<#if title != "">
			<h3 ${idTitle}>${title?html}</h3>
		</#if>
		<section ${idContent} class="panel-content">
			<#nested>
		</section>
	</section>
</#macro>

<#macro dynamicsection id>
	<div id="${id?html}">
		TODO Loads ${id?html}
		<div id="${id?html}-footer">
			<#nested />
		</div>
	</div>
</#macro>

<#macro dialog id title>
	<#assign dialogId = id />
	<#assign dialogButtons = [] />
	<#assign content><#nested/></#assign>
	<div id="${id?html}" class="modal hide fade" tabindex="-1" role="dialog" aria-labelledby="${id?html}-label" aria-hidden="true" data-keyboard="true">
		<div class="modal-header">
			<button type="button" class="close" data-dismiss="modal" aria-hidden="true">&#215;</button>
			<h3 id="${id?html}-label">${title?html}</h3>
		</div>
		<div class="modal-body">
			${content}
		</div>
		<div class="modal-footer">
			<#list dialogButtons as dialogButton>
				${dialogButton}
			</#list>
		</div>
	</div>
	<#assign dialogId = "" />
</#macro>

<#macro dialog_button id text class="" extra="" main=true>
	<#if dialogId?? && dialogId != "">
		<#assign attributes = extra />
		<#assign buttonType = "button" />
		<#if main>
			<#assign attributes = attributes + ' x-main="true"' />
			<#assign buttonType = "submit" />
		</#if>
		<#assign dialogButton><button type="${buttonType?html}" class="btn ${class?html}" ${attributes}>${text?html}</button></#assign>
		<#assign dialogButtons = dialogButtons + [ dialogButton ] />
	<#else>
		<#stop "'dialog_button' must be used inside a 'dialog' directive" />
	</#if>
</#macro>

<#macro dialog_button_cancel>
	<#if dialogId?? && dialogId != "">
		<@dialog_button id=dialogId+"cancel" class="btn-link" text=loc('general.cancel') extra='data-dismiss="modal" aria-hidden="true"' main=false />
	<#else>
		<#stop "'dialog_button_cancel' must be used inside a 'dialog' directive" />
	</#if>
</#macro>

<#macro form>
	<form class="form-horizontal">
		<#nested />
	</form>
</#macro>

<#macro form_text name label idPrefix="" size=40 maxlength=80 placeholder="" help="">
	<#assign id = idPrefix + name />
	<div class="control-group">
		<label class="control-label" for="${id?html}">${label?html}</label>
		<div class="controls">
			<input name="${name?html}" type="text" id="${id?html}" placeholder="${placeholder?html}" size="${size}" maxlength="${maxlength}" />
			<#if help != "">
				<span class="help-block">${help?html}</span>
			</#if>
		</div>
	</div>
</#macro>