<script type="text/javascript" src="${base}/js/audit.js"></script>

<#macro audit id="audit" filter="" title=loc("event.list")>

    <section class="panel" id="${id?html}">
        <h4>
            ${title?html}
            <#if filter != "" && secSubscriber()>
                <#if subscribed(filter)>
                    <img id="subscription" src="${base}/images/unsubscription.png" class="action" title="<@lh key='subscription.disable' />" onclick="Audit.unsubscribe('${filter}')" />
                <#else>
                    <img id="subscription" src="${base}/images/subscription.png" class="action" title="<@lh key='subscription.enable' />" onclick="Audit.subscribe('${filter}')" />
                </#if>
            </#if>
        </h4>
        <div id="subscription-notification" class="alert alert-info hidden">
            <span id="subscription-notification-message"></span>
            <button type="button" class="close" onclick="$('#subscription-notification').hide();">&times;</button>
        </div>
        <@dynamicsection id=id template="Audit.auditTemplate('${filter}')">
        </@dynamicsection>
     </section>
    <script id="auditTemplate" type="text/html">
        <tr>
            <td>
                <div class="status-{{status}}">
                    {{#if icon}}
                        <img width="24" src="{{icon}}" class="event-icon" />
                    {{/if}}
                    {{{html}}}
                    <span class="elapsed">- <span title="{{timestamp}}">{{elapsed}}</span></span>
                </div>
            </td>
        </tr>
    </script>
</#macro>
