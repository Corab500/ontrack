<#include "/lib/layout.html">

<@layout_std page="promotion_level" title=promotionLevel.name modules=["projects","branches","builds","validation_stamps","promotion_levels","audit","properties"] breadcrumbs = {loc("home"): "", promotionLevel.branch.project.name?html: "gui/project/${promotionLevel.branch.project.name?html}", promotionLevel.branch.name?html: "gui/project/${promotionLevel.branch.project.name?html}/branch/${promotionLevel.branch.name?html}"}>
	<div class="container-fluid">
        <div class="row-fluid">
            <div class="span12 page-title">
                <span class="title">
                    <a href="gui/project/${promotionLevel.branch.project.name?html}">${promotionLevel.branch.project.name?html}</a>
                    / <a href="gui/project/${promotionLevel.branch.project.name?html}/branch/${promotionLevel.branch.name?html}">${promotionLevel.branch.name?html}</a>
                    / <@promotion_level_img promotionLevel=promotionLevel /> ${promotionLevel.name?html}</span>
                <span class="action action-optional">
                    <#if secAdmin()>
                        <span onclick="PromotionLevels.updatePromotionLevel('${promotionLevel.branch.project.name?html}','${promotionLevel.branch.name?html}','${promotionLevel.name?html}');"><i class="icon-pencil"></i> <@lh key="general.modify" /></span>
                        <span onclick="PromotionLevels.editImage();"><i class="icon-edit"></i> <@lh key="promotion_level.image.edit" /></span>
                        <a href="gui/project/${promotionLevel.branch.project.name?html}/branch/${promotionLevel.branch.name?html}/promotion_level_manage"><i class="icon-th"></i> <@lh key="promotion_level.manage" /></a>
                        <span onclick="PromotionLevels.deletePromotionLevel('${promotionLevel.branch.project.name?html}','${promotionLevel.branch.name?html}','${promotionLevel.name?html}');"><i class="icon-trash"></i> <@lh key="general.delete" /></span>
                    </#if>
                    <a href="gui/project/${promotionLevel.branch.project.name?html}/branch/${promotionLevel.branch.name?html}"><i class="icon-remove"></i> <@lh key="general.close" /></a>
                </span>
            </div>
            <div class="muted span12 properties">${promotionLevel.description?html}</div>
            <div class="span12 properties">
                <@properties entity="PROMOTION_LEVEL" entityId=promotionLevel.id />
            </div>
        </div>
        <div id="promotion_level-image-form" class="row-fluid x-dialog">
            <form class="span4 alert alert-info" method="POST" enctype="multipart/form-data" action="gui/project/${promotionLevel.branch.project.name?html}/branch/${promotionLevel.branch.name?html}/promotion_level/${promotionLevel.name?html}/image">
                <input id="promotion_level.image.file" name="image" type="file" accept=".png,image/png" required="required" placeholder="<@lh key='promotion_level.image.placeholder'/>" />
                <p class="help-block"><@lh key="promotion_level.image.help" /></p>
                <button id="promotion_level.image.submit" type="submit" class="btn btn-primary"><@lh key="general.submit"/></button>
                <button id="promotion_level.image.cancel" type="button" class="btn btn-link" onclick="PromotionLevels.editImageCancel()"><@lh key="general.cancel"/></button>
            </form>
            <div class="span12 muted">${promotionLevel.description?html}</div>
        </div>
		<div class="row-fluid">
			<div class="span12">
				<@audit filter="&promotionLevel=${promotionLevel.id}" />
			</div>
		</div>
	</div>

    <@dialog id="promotion_level-update-dialog">
        <@form_text idPrefix="promotion_level-update-dialog-" name="name" label=loc('promotion_level.name') />
        <@form_memo idPrefix="promotion_level-update-dialog-" name="description" label=loc('promotion_level.description') required=false />

        <@dialog_button id="promotion_level-update-dialog-submit" class="btn-primary" text=loc('general.modify') />
        <@dialog_button_cancel />
    </@dialog>
</@layout_std>