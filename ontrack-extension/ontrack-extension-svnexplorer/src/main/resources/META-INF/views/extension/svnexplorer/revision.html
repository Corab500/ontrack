<#include "/lib/layout.html">

<@layout_std page="svnexplorer.revision" title=loc("svnexplorer.revision", info.changeLogRevision.revision?c) style=true extension=true breadcrumbs={loc("home"):""}>

    <div class="row-fluid">
        <div class="span12 page-title">
                <span class="title">
                    <#assign revisionLink><a href="${info.changeLogRevision.revisionUrl}">${info.changeLogRevision.revision?c}</a></#assign>
                    ${loc("svnexplorer.revision", revisionLink)}
                </span>
                <span class="action action-optional">
                    <a href=""><i class="icon-remove"></i> <@lh key="general.close" /></a>
                </span>
        </div>
    </div>

    <div class="row-fluid">
        <div class="span12">
            <table>
                <tbody>
                    <tr>
                        <td class="revision-info-label"><@lh key="svnexplorer.changelog.revisions.author" /></td>
                        <td class="revision-info-value">${info.changeLogRevision.author?html}</td>
                    </tr>
                    <tr>
                        <td class="revision-info-label"><@lh key="svnexplorer.changelog.revisions.date" /></td>
                        <td class="revision-info-value">${info.changeLogRevision.isoDateTime?html}</td>
                    </tr>
                    <tr>
                        <td class="revision-info-label"><@lh key="svnexplorer.changelog.revisions.message" /></td>
                        <td class="revision-info-value">${info.changeLogRevision.formattedMessage}</td>
                    </tr>
                </tbody>
            </table>
        </div>
    </div>


    <div class="row-fluid">
        <div class="span12">
            <h1><small><@lh key="svnexplorer.revision.builds" /></small></h1>
            <table class="table">
                <thead>
                    <tr>
                        <th><@lh key="model.project" /></th>
                        <th><@lh key="model.branch" /></th>
                        <th><@lh key="model.build" /></th>
                        <th><@lh key="build.promotion_levels" /></th>
                        <th><@lh key="build.validation_stamps" /></th>
                    </tr>
                </thead>
                <tbody>
                    <#list info.builds as build>
                        <tr>
                            <td>
                                <a href="gui/project/${build.build.branch.project.name?html}">${build.build.branch.project.name?html}</a>
                            </td>
                            <td>
                                <a href="gui/project/${build.build.branch.project.name?html}/branch/${build.build.branch.name?html}">${build.build.branch.name?html}</a>
                            </td>
                            <td>
                                <a href="gui/project/${build.build.branch.project.name?html}/branch/${build.build.branch.name?html}/build/${build.build.name?html}">${build.build.name?html}</a>
                            </td>
                            <td>
                                <ul class="promotions">
                                    <#list build.buildPromotionLevels as buildPromotionLevel>
                                        <li>
                                            <i class="icon-arrow-right"></i>
                                            <img width="24" title="${buildPromotionLevel.name?html}" src="gui/project/${build.build.branch.project.name?html}/branch/${build.build.branch.name?html}/promotion_level/${buildPromotionLevel.name?html}/image" />
                                            <a href="gui/project/${build.build.branch.project.name?html}/branch/${build.build.branch.name?html}/promotion_level/${buildPromotionLevel.name?html}">${buildPromotionLevel.name?html}</a>
                                        </li>
                                    </#list>
                                </ul>
                            </td>
                            <td>
                                <#list build.buildValidationStamps as buildValidationStamp>
                                    <#if buildValidationStamp.run>
                                        <#assign run = buildValidationStamp.runs?first />
                                        <span class="label validationStamp">
                                            <img width="24" title="${buildValidationStamp.name?html}" src="gui/project/${build.build.branch.project.name?html}/branch/${build.build.branch.name?html}/validation_stamp/${buildValidationStamp.name?html}/image" />
                                            <a href="gui/project/${build.build.branch.project.name?html}/branch/${build.build.branch.name?html}/build/${build.build.name?html}/validation_stamp/${buildValidationStamp.name?html}/validation_run/${run.runOrder?c}">${buildValidationStamp.name?html}</a>
                                            <img width="24" src="static/images/status-${run.status}.png" />
                                        </span>
                                    </#if>
                                </#list>
                            </td>
                        </tr>
                    </#list>
                </tbody>
            </table>
        </div>
    </div>

</@layout_std>